# Веб-сайт на Django 
Доска объявлений для фанатского сервера MMORPG

Доступны следующие функции:
- регистрация пользователя
- создание и редактирование объявлений с тектовым и мультимедийным контентом
- просмотр, удаление и прием откликов в личном кабинете
- получение email-уведомлений о действиях
- новостные рассылки для пользователей

## Запуск проекта
Для запуска в среде PyCharm необходимо:
- активировать виртуальную машину `venv\scripts\activate`
- перейти в в папку pereval `cd pereval`
- запустить сервер `python manage.py runserver`

Rest API работает с базой данных Posgresql, параметры подключения к БД реализованы через переменные окружения:
```
name='DATABASE_NAME'
user='DATABASE_USER'
password='DATABASE_PASSWORD'
host='DATABASE_HOST'
port='DATABASE_PORT'
```

## Внесение информации о новом объекте
Для внесения информации о новом объекте необходимо ввести в строку `http://127.0.0.1:8000/post/`

Данные передаются в формате JSON в виде:
```
{
    {
        "user": {
            "email": "user@mail.ru",
            "first_name": "Петр",
            "last_name": "Петров",
            "father_name": "Петрович",
            "phone": "78008888888"
        },
        "coords": {
            "latitude": 26.4324,
            "longitude": 43.4565,
            "height": 2500
        },
        "image":[ 
	      {
                "title": "вершина",
                "image": "<картинка1>",
        },
        {
                "title": "вершина2",
                "image": "<картинка2>",
        }     
        ],
        "beauty_title": "холм",
        "title": "Шерегеш",
        "other_title": "Горнолыжка",
        "connect": "",
        "level_summer": "",
        "level_autumn": "",
        "level_winter": "",
        "level_spring": "",
        "date_added": "2020-6-12 14:18:15"
}
```
Картинки загружаются в формате Base64 в неограниченном количестве.

Результат метода:
- status — код HTTP, целое число:
   - 500 — ошибка при выполнении операции;
   - 400 — Bad Request (при нехватке полей)
   - 200 — успех.
- message — строка:
   - Причина ошибки (если она была);
   - Отправлено успешно;
- id идентификатор записи в базе данных, если отправка успешна

## Получить запись по идентификатору
Для получения всей информации об объекте, в том числе статус модерации, по id: `http://127.0.0.1:8000/get/id/`

## Получить все записи пользователя по email
Для получения списка данных обо всех объектах, которые пользователь с почтой email отправил на сервер: `http://127.0.0.1:8000/get/?user__email=<email>`

## Редактирование записи
Редактировать можно только записи, находящиеся в процессе модерации со статусом new.

Для редактирования записи по идентификатору: `http://127.0.0.1:8000/patch/id/`

Изменяемые поля вводятся в формате JSON, например:
```
{
  "coords": {
            "latitude": 10.3456
   }
}
```
Редактировать можно все поля, кроме пользовательских данных.

Результат метода:
- state — целое число:
   - 405 — ошибка при выполнении операции;
   - 1 — успех.

